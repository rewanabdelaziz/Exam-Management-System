<div class="dashboard min-vh-100 bg-light">
  <app-student-header [currentStudent]="{name:studentInfo()?.name! , email: studentInfo()?.email!}"></app-student-header>
  
  <div class="container py-2">
    <div class="title text-center text-md-start mb-4">
      <h2 class="fw-bold">Available Exams</h2>
      <p class="text-muted">Select an exam to start or view your results.</p>
    </div>
        
    <div class="tab mb-5 mx-auto">
       <button class="tablinks left" (click)="toggle(false)" [class.active]="!isResults">Available Exams</button>
       <button class="tablinks right" (click)="toggle(true)" [class.active]="isResults">Exam Results</button>
    </div>
    
    <div class="cards-grid">
      @if(!isResults){
        @for(exam of availableExams(); track exam._id){
          <div class="exam-card p-4 rounded bg-white">
            <div class="header d-flex justify-content-between align-items-start mb-3">
               <div class="left-icon bg-light p-2 rounded text-primary">
                 <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
               </div>
               <div class="right-icon">
                  <span class="badge rounded-pill bg-secondary-subtle text-primary px-3 py-2">
                    Not Started
                  </span>
               </div>
            </div>
            
            <div class="card-content">
              <h4 class="h5 fw-bold">{{exam.title}}</h4>
              <p class="text-muted small mb-3">{{exam.description | slice:0:100}}...</p>
              
              <table class="table table-sm table-borderless border-top pt-2">
                <tbody class="small">
                  <tr><td>Questions</td><td class="text-end fw-bold">{{exam.totalQuestions}}</td></tr>
                  <tr><td>Duration</td><td class="text-end fw-bold">{{exam.duration}} min</td></tr>
                  <tr><td>Passing Score</td><td class="text-end fw-bold text-success">{{exam.passingScore}}%</td></tr>
                </tbody>
              </table>
            </div>

            <button type="button" class="btn btn-primary w-100 mt-auto py-2 fw-bold" (click)="startExam(exam._id!)">
              Start Exam
            </button>
          </div>
        } @empty {
          <div class="text-center w-100 p-5 bg-white rounded border">
            <p class="text-muted m-0">No available exams at the moment.</p>
          </div>
        }
      } @else {
        @for(exam of TakenExams(); track exam._id){
           <div class="exam-card p-4 rounded bg-white border-success-subtle">
              <div class="header d-flex justify-content-between mb-3">
                 <div class="left-icon text-success">
                    </div>
                 <span class="badge bg-success">Finished</span>
              </div>
              <h4 class="h5 fw-bold mb-4">{{exam.title}}</h4>
              <button class="btn btn-outline-primary w-100 mt-auto" [routerLink]="['/studentDashboard/resultPage', exam._id]">
                Show Result
              </button>
           </div>
        }@empty {
          <div class="text-center w-100 p-5 bg-white rounded border">
            <p class="text-muted m-0">No available Results at the moment.</p>
          </div>
        }
      }
    </div>
  </div>
</div>